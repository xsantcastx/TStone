<app-admin-sidebar></app-admin-sidebar>

<div class="lg:ml-[280px] min-h-screen pt-16 lg:pt-0 bg-gradient-to-b from-ts-paper to-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Header -->
    <div class="mb-8 flex items-center justify-between">
      <div>
        <h1 class="text-3xl font-serif font-bold text-black mb-2">Gestión de Datos Técnicos</h1>
        <p class="text-gray-600">Administra toda la información técnica del sitio</p>
      </div>
      <button
        (click)="openTranslationModal()"
        class="px-4 py-3 bg-white border-2 border-gray-300 text-gray-900 font-semibold rounded-xl hover:bg-gray-50 transition-all flex items-center gap-2 whitespace-nowrap">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
        </svg>
        <span>Traducir Todo</span>
      </button>
    </div>

    <!-- Success/Error Messages -->
    @if (successMessage()) {
      <div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-xl flex items-start gap-3">
        <svg class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-sm text-green-700 font-medium">{{ successMessage() }}</p>
      </div>
    }

    @if (errorMessage()) {
      <div class="mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3">
        <svg class="w-5 h-5 text-red-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-sm text-red-700 font-medium">{{ errorMessage() }}</p>
      </div>
    }

    <!-- Main Content Card -->
    <div class="bg-white rounded-2xl shadow-lg border border-gray-100 p-4 sm:p-6">
      
      <!-- Tabs -->
      <div class="flex gap-2 mb-6 border-b border-gray-200 overflow-x-auto pb-2 -mx-2 px-2 sm:mx-0 sm:px-0">
        <button
          (click)="activeTab.set('specs')"
          [class.border-ts-accent]="activeTab() === 'specs'"
          [class.text-white]="activeTab() === 'specs'"
          [class.bg-ts-accent]="activeTab() === 'specs'"
          [class.bg-white]="activeTab() !== 'specs'"
          [class.border-gray-300]="activeTab() !== 'specs'"
          [style.color]="activeTab() !== 'specs' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Especificaciones
        </button>
        <button
          (click)="activeTab.set('acabados')"
          [class.border-ts-accent]="activeTab() === 'acabados'"
          [class.text-white]="activeTab() === 'acabados'"
          [class.bg-ts-accent]="activeTab() === 'acabados'"
          [class.bg-white]="activeTab() !== 'acabados'"
          [class.border-gray-300]="activeTab() !== 'acabados'"
          [style.color]="activeTab() !== 'acabados' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Acabados
        </button>
        <button
          (click)="activeTab.set('fichas')"
          [class.border-ts-accent]="activeTab() === 'fichas'"
          [class.text-white]="activeTab() === 'fichas'"
          [class.bg-ts-accent]="activeTab() === 'fichas'"
          [class.bg-white]="activeTab() !== 'fichas'"
          [class.border-gray-300]="activeTab() !== 'fichas'"
          [style.color]="activeTab() !== 'fichas' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Fichas Técnicas
        </button>
        <button
          (click)="activeTab.set('packing')"
          [class.border-ts-accent]="activeTab() === 'packing'"
          [class.text-white]="activeTab() === 'packing'"
          [class.bg-ts-accent]="activeTab() === 'packing'"
          [class.bg-white]="activeTab() !== 'packing'"
          [class.border-gray-300]="activeTab() !== 'packing'"
          [style.color]="activeTab() !== 'packing' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Embalaje
        </button>
        <button
          (click)="activeTab.set('bordes')"
          [class.border-ts-accent]="activeTab() === 'bordes'"
          [class.text-white]="activeTab() === 'bordes'"
          [class.bg-ts-accent]="activeTab() === 'bordes'"
          [class.bg-white]="activeTab() !== 'bordes'"
          [class.border-gray-300]="activeTab() !== 'bordes'"
          [style.color]="activeTab() !== 'bordes' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Bordes
        </button>
        <button
          (click)="activeTab.set('fachada')"
          [class.border-ts-accent]="activeTab() === 'fachada'"
          [class.text-white]="activeTab() === 'fachada'"
          [class.bg-ts-accent]="activeTab() === 'fachada'"
          [class.bg-white]="activeTab() !== 'fachada'"
          [class.border-gray-300]="activeTab() !== 'fachada'"
          [style.color]="activeTab() !== 'fachada' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Fachada
        </button>
        <button
          (click)="activeTab.set('mantenimiento')"
          [class.border-ts-accent]="activeTab() === 'mantenimiento'"
          [class.text-white]="activeTab() === 'mantenimiento'"
          [class.bg-ts-accent]="activeTab() === 'mantenimiento'"
          [class.bg-white]="activeTab() !== 'mantenimiento'"
          [class.border-gray-300]="activeTab() !== 'mantenimiento'"
          [style.color]="activeTab() !== 'mantenimiento' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Mantenimiento
        </button>
        <button
          (click)="activeTab.set('tests')"
          [class.border-ts-accent]="activeTab() === 'tests'"
          [class.text-white]="activeTab() === 'tests'"
          [class.bg-ts-accent]="activeTab() === 'tests'"
          [class.bg-white]="activeTab() !== 'tests'"
          [class.border-gray-300]="activeTab() !== 'tests'"
          [style.color]="activeTab() !== 'tests' ? '#000000 !important' : ''"
          class="px-3 sm:px-4 py-3 font-bold border-2 rounded-t-lg transition-colors whitespace-nowrap text-sm">
          Tests de Producto
        </button>
      </div>

      <!-- Especificaciones Tab -->
      @if (activeTab() === 'specs') {
        <div>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-black">Especificaciones Técnicas</h2>
          </div>

          <!-- Add New Spec -->
          <div class="mb-6 p-4 bg-gray-50 rounded-xl border border-gray-200">
            <h3 class="font-medium text-black mb-3">Añadir Especificación</h3>
            <div class="grid md:grid-cols-2 gap-4">
              <input
                type="text"
                [(ngModel)]="editingSpec.key"
                placeholder="Clave (ej: absorcionAgua)"
                class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
              <input
                type="text"
                [(ngModel)]="editingSpec.value"
                placeholder="Valor (ej: ≤ 0,5%)"
                class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
            </div>
            <button
              (click)="addSpec()"
              [disabled]="!editingSpec.key || !editingSpec.value"
              class="mt-3 px-4 py-2 bg-ts-accent text-white rounded-lg hover:bg-ts-accent/90 disabled:opacity-50 disabled:cursor-not-allowed">
              Añadir
            </button>
          </div>

          <!-- Specs List -->
          <div class="space-y-3">
            @for (spec of getSpecEntries(); track spec.key) {
                            <div class="flex items-start gap-3 p-4 bg-white border border-gray-200 rounded-lg">
                <div class="flex-1 space-y-3">
                  <div class="grid md:grid-cols-2 gap-3">
                    <div>
                      <label class="text-sm text-gray-600 font-medium">Clave</label>
                      <p class="text-black">{{ spec.key }}</p>
                    </div>
                    <div>
                      <label class="text-sm text-gray-600 font-medium">Valor</label>
                      <input
                        type="text"
                        [value]="spec.value"
                        (input)="updateSpec(spec.key, $any($event.target).value)"
                        class="w-full px-3 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-ts-accent text-black">
                    </div>
                  </div>
                  <div>
                    <label class="text-xs font-semibold text-gray-700">Valor por idioma</label>
                    <div class="grid sm:grid-cols-2 gap-3 mt-2">
                      @for (lang of languages; track lang.code) {
                        <div class="space-y-1">
                          <div class="flex items-center justify-between">
                            <span class="text-[10px] font-semibold text-gray-600">{{ lang.name }} ({{ lang.label }})</span>
                            @if (lang.code === defaultLanguage) {
                              <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                            }
                          </div>
                          <input
                            type="text"
                            [value]="datosTecnicos().especificacionesTecnicasTranslations?.[spec.key]?.[lang.code] || (lang.code === defaultLanguage ? spec.value : '')"
                            (input)="updateSpecTranslation(spec.key, lang.code, $any($event.target).value)"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                            placeholder="Valor en {{ lang.name }}">
                        </div>
                      }
                    </div>
                  </div>
                </div>
                <button
                  (click)="removeSpec(spec.key)"
                  class="p-2 text-red-600 hover:bg-red-50 rounded-lg mt-1">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                </button>
              </div>
            }
            @empty {
              <p class="text-center text-gray-500 py-8">No hay especificaciones configuradas</p>
            }
          </div>
        </div>
      }

      <!-- Acabados Tab -->
      @if (activeTab() === 'acabados') {
        <div>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-black">Acabados de Superficie</h2>
            <button
              (click)="addAcabado()"
              class="px-4 py-2 bg-ts-accent text-white rounded-xl hover:bg-ts-accent/90 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              Añadir Acabado
            </button>
          </div>

          <div class="space-y-6">
            @for (acabado of datosTecnicos().acabadosSuperficie; track $index) {
              <div class="p-4 border border-gray-200 rounded-xl bg-gray-50">
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Nombre</label>
                    <input
                      type="text"
                      [value]="acabado.nombre"
                      (input)="updateAcabado($index, 'nombre', $any($event.target).value)"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Imagen</label>
                    <div class="flex gap-2">
                      <input
                        type="file"
                        (change)="uploadAcabadoImage($event, $index)"
                        accept="image/*"
                        class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm">
                      @if (acabado.imagen) {
                        <img [src]="acabado.imagen" alt="Preview" class="w-16 h-16 object-cover rounded-lg">
                      }
                    </div>
                  </div>
                </div>
                <div class="mb-4">
                  <label class="block text-sm font-medium text-black mb-1">Descripción</label>
                  <textarea
                    [value]="acabado.descripcion"
                    (input)="updateAcabado($index, 'descripcion', $any($event.target).value)"
                    rows="2"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"></textarea>
                </div>
                <div class="mb-4">
                  <label class="block text-sm font-medium text-black mb-2">DescripciA3n por idioma</label>
                  <div class="grid sm:grid-cols-2 gap-3">
                    @for (lang of languages; track lang.code) {
                      <div class="space-y-1">
                        <div class="flex items-center justify-between">
                          <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                          @if (lang.code === defaultLanguage) {
                            <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                          }
                        </div>
                        <textarea
                          rows="2"
                          [value]="acabado.descripcionTranslations?.[lang.code] || (lang.code === defaultLanguage ? acabado.descripcion : '')"
                          (input)="updateAcabadoDescripcionTranslation($index, lang.code, $any($event.target).value)"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                          placeholder="DescripciA3n en {{ lang.name }}"></textarea>
                      </div>
                    }
                  </div>
                </div>
                <div class="mb-4">
                  <label class="block text-sm font-medium text-black mb-2">Alt text por idioma</label>
                  <div class="grid sm:grid-cols-2 gap-3">
                    @for (lang of languages; track lang.code) {
                      <div class="space-y-1">
                        <div class="flex items-center justify-between">
                          <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                          @if (lang.code === defaultLanguage) {
                            <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                          }
                        </div>
                        <input
                          type="text"
                          [value]="acabado.altTranslations?.[lang.code] || (lang.code === defaultLanguage ? (acabado.alt || acabado.nombre) : '')"
                          (input)="updateAcabadoAlt($index, lang.code, $any($event.target).value)"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                          placeholder="Texto alternativo en {{ lang.name }}">
                      </div>
                    }
                  </div>
                  <p class="text-xs text-gray-600 mt-1">Usado para accesibilidad e idiomas en la galerA-a y fichas.</p>
                </div>
                <button
                  (click)="removeAcabado($index)"
                  class="bg-red-50 text-red-700 hover:bg-red-100 border border-red-200 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                  Eliminar Acabado
                </button>
              </div>
            }
            @empty {
              <p class="text-center text-gray-500 py-8">No hay acabados configurados</p>
            }
          </div>
        </div>
      }

      <!-- Fichas Tab -->
      @if (activeTab() === 'fichas') {
        <div>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-black">Fichas TAccnicas</h2>
            <button
              (click)="addFicha()"
              class="px-4 py-2 bg-ts-accent text-white rounded-xl hover:bg-ts-accent/90 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              AA�adir Ficha
            </button>
          </div>

          <div class="space-y-4">
            @for (ficha of datosTecnicos().fichasTecnicas; track $index) {
              <div class="p-4 border border-gray-200 rounded-xl bg-gray-50">
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Nombre</label>
                    <input
                      type="text"
                      [value]="ficha.nombre"
                      (input)="updateFicha($index, 'nombre', $any($event.target).value)"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">URL</label>
                    <input
                      type="text"
                      [value]="ficha.url"
                      (input)="updateFicha($index, 'url', $any($event.target).value)"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Tamano</label>
                    <input
                      type="text"
                      [value]="ficha.tamano"
                      (input)="updateFicha($index, 'tamano', $any($event.target).value)"
                      placeholder="ej: 1.8MB"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">DescripciA3n</label>
                    <input
                      type="text"
                      [value]="ficha.descripcion"
                      (input)="updateFicha($index, 'descripcion', $any($event.target).value)"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-black mb-2">DescripciA3n por idioma</label>
                    <div class="grid sm:grid-cols-2 gap-3">
                      @for (lang of languages; track lang.code) {
                        <div class="space-y-1">
                          <div class="flex items-center justify-between">
                            <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                            @if (lang.code === defaultLanguage) {
                              <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                            }
                          </div>
                          <textarea
                            rows="2"
                            [value]="ficha.descripcionTranslations?.[lang.code] || (lang.code === defaultLanguage ? ficha.descripcion : '')"
                            (input)="updateFichaDescripcionTranslation($index, lang.code, $any($event.target).value)"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                            placeholder="DescripciA3n en {{ lang.name }}"></textarea>
                        </div>
                      }
                    </div>
                  </div>
                </div>
                <button
                  (click)="removeFicha($index)"
                  class="mt-3 text-red-600 hover:text-red-700 text-sm font-medium">
                  Eliminar Ficha
                </button>
              </div>
            }
            @empty {
              <p class="text-center text-gray-500 py-8">No hay fichas tAccnicas configuradas</p>
            }
          </div>
        </div>
      }

      <!-- Packing Tab -->
      @if (activeTab() === 'packing') {
        <div>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-black">InformaciA3n de Embalaje</h2>
            <button
              (click)="addPacking()"
              class="px-4 py-2 bg-ts-accent text-white rounded-xl hover:bg-ts-accent/90 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              AA�adir Embalaje
            </button>
          </div>
          <div class="mb-6">
            <label class="block text-sm font-medium text-black mb-2">DescripciA3n de Embalaje</label>
            <textarea
              [value]="datosTecnicos().packingDescripcion"
              (input)="updatePackingDescripcion($any($event.target).value)"
              rows="2"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"></textarea>
          </div>

          <div class="mb-6">
            <label class="block text-sm font-medium text-black mb-2">DescripciA3n por idioma</label>
            <div class="grid sm:grid-cols-2 gap-3">
              @for (lang of languages; track lang.code) {
                <div class="space-y-1">
                  <div class="flex items-center justify-between">
                    <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                    @if (lang.code === defaultLanguage) {
                      <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                    }
                  </div>
                  <textarea
                    rows="2"
                    [value]="datosTecnicos().packingDescripcionTranslations?.[lang.code] || (lang.code === defaultLanguage ? (datosTecnicos().packingDescripcion || '') : '')"
                    (input)="updatePackingDescripcionTranslation(lang.code, $any($event.target).value)"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                    placeholder="DescripciA3n en {{ lang.name }}"></textarea>
                </div>
              }
            </div>
          </div>

          <div class="space-y-4">
            @for (pack of datosTecnicos().packing; track $index) {
              <div class="p-4 border border-gray-200 rounded-xl bg-gray-50">
                <div class="grid md:grid-cols-3 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Grosor</label>
                    <input
                      type="text"
                      [value]="pack.grosor"
                      (input)="updatePacking($index, 'grosor', $any($event.target).value)"
                      placeholder="ej: 12mm"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Piezas por Pallet</label>
                    <input
                      type="number"
                      [value]="pack.piezasPorPallet"
                      (input)="updatePacking($index, 'piezasPorPallet', toNumber($any($event.target).value))"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Peso Aprox.</label>
                    <input
                      type="text"
                      [value]="pack.pesoAprox"
                      (input)="updatePacking($index, 'pesoAprox', $any($event.target).value)"
                      placeholder="ej: ~350kg"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Dimensiones Pallet</label>
                    <input
                      type="text"
                      [value]="pack.dimensionesPallet"
                      (input)="updatePacking($index, 'dimensionesPallet', $any($event.target).value)"
                      placeholder="ej: 165 x 325 x 45 cm"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Superficie</label>
                    <input
                      type="text"
                      [value]="pack.superficie"
                      (input)="updatePacking($index, 'superficie', $any($event.target).value)"
                      placeholder="ej: 51,84 mAi"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Superficie Pallet</label>
                    <input
                      type="text"
                      [value]="pack.superficiePallet"
                      (input)="updatePacking($index, 'superficiePallet', $any($event.target).value)"
                      placeholder="ej: 5,36 mAi"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Peso Pallet</label>
                    <input
                      type="text"
                      [value]="pack.pesoPallet"
                      (input)="updatePacking($index, 'pesoPallet', $any($event.target).value)"
                      placeholder="ej: 1850 kg"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                </div>
                <button
                  (click)="removePacking($index)"
                  class="mt-3 text-red-600 hover:text-red-700 text-sm font-medium">
                  Eliminar Embalaje
                </button>
              </div>
            }
            @empty {
              <p class="text-center text-gray-500 py-8">No hay informaciA3n de embalaje configurada</p>
            }
          </div>
        </div>
      }

      <!-- Bordes Tab -->
      @if (activeTab() === 'bordes') {
        <div>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-black">Acabados de Bordes</h2>
            <button
              (click)="addBorde()"
              class="px-4 py-2 bg-ts-accent text-white rounded-xl hover:bg-ts-accent/90 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              AA�adir Borde
            </button>
          </div>

          <div class="space-y-6">
            @for (borde of datosTecnicos().acabadosBordes; track $index) {
              <div class="p-4 border border-gray-200 rounded-xl bg-gray-50">
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Nombre</label>
                    <input
                      type="text"
                      [value]="borde.nombre"
                      (input)="updateBorde($index, 'nombre', $any($event.target).value)"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Imagen</label>
                    <div class="flex gap-2">
                      <input
                        type="file"
                        (change)="uploadBordeImage($event, $index)"
                        accept="image/*"
                        class="flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm">
                      @if (borde.imagen) {
                        <img [src]="borde.imagen" alt="Preview" class="w-16 h-16 object-cover rounded-lg">
                      }
                    </div>
                  </div>
                </div>
                <div class="mb-4">
                  <label class="block text-sm font-medium text-black mb-1">DescripciA3n</label>
                  <textarea
                    [value]="borde.descripcion"
                    (input)="updateBorde($index, 'descripcion', $any($event.target).value)"
                    rows="2"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"></textarea>
                </div>
                <div class="mb-4">
                  <label class="block text-sm font-medium text-black mb-2">DescripciA3n por idioma</label>
                  <div class="grid sm:grid-cols-2 gap-3">
                    @for (lang of languages; track lang.code) {
                      <div class="space-y-1">
                        <div class="flex items-center justify-between">
                          <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                          @if (lang.code === defaultLanguage) {
                            <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                          }
                        </div>
                        <textarea
                          rows="2"
                          [value]="borde.descripcionTranslations?.[lang.code] || (lang.code === defaultLanguage ? borde.descripcion : '')"
                          (input)="updateBordeDescripcionTranslation($index, lang.code, $any($event.target).value)"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                          placeholder="DescripciA3n en {{ lang.name }}"></textarea>
                      </div>
                    }
                  </div>
                </div>
                <div class="mb-4">
                  <label class="block text-sm font-medium text-black mb-2">Alt text por idioma</label>
                  <div class="grid sm:grid-cols-2 gap-3">
                    @for (lang of languages; track lang.code) {
                      <div class="space-y-1">
                        <div class="flex items-center justify-between">
                          <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                          @if (lang.code === defaultLanguage) {
                            <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                          }
                        </div>
                        <input
                          type="text"
                          [value]="borde.altTranslations?.[lang.code] || (lang.code === defaultLanguage ? (borde.alt || borde.nombre) : '')"
                          (input)="updateBordeAlt($index, lang.code, $any($event.target).value)"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                          placeholder="Texto alternativo en {{ lang.name }}">
                      </div>
                    }
                  </div>
                  <p class="text-xs text-gray-600 mt-1">Describe la imagen en cada idioma para SEO y accesibilidad.</p>
                </div>
                <button
                  (click)="removeBorde($index)"
                  class="bg-red-50 text-red-700 hover:bg-red-100 border border-red-200 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                  Eliminar Borde
                </button>
              </div>
            }
            @empty {
              <p class="text-center text-gray-500 py-8">No hay bordes configurados</p>
            }
          </div>
        </div>
      }
      <!-- Fachada Tab -->
      @if (activeTab() === 'fachada') {
        <div>
          <h2 class="text-xl font-serif font-bold text-black mb-6">Fijaciones para Fachada</h2>

          <div class="space-y-6">
            <div>
              <label class="block text-sm font-medium text-black mb-2">Descripción</label>
              <textarea
                [value]="datosTecnicos().fijacionesFachada.descripcion"
                (input)="updateFijacion('descripcion', $any($event.target).value)"
                rows="3"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-black mb-2">DescripciA3n por idioma</label>
              <div class="grid sm:grid-cols-2 gap-3">
                @for (lang of languages; track lang.code) {
                  <div class="space-y-1">
                    <div class="flex items-center justify-between">
                      <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                      @if (lang.code === defaultLanguage) {
                        <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                      }
                    </div>
                    <textarea
                      rows="2"
                      [value]="datosTecnicos().fijacionesFachada.descripcionTranslations?.[lang.code] || (lang.code === defaultLanguage ? datosTecnicos().fijacionesFachada.descripcion : '')"
                      (input)="updateFachadaDescripcionTranslation(lang.code, $any($event.target).value)"
                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                      placeholder="DescripciA3n en {{ lang.name }}"></textarea>
                  </div>
                }
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-black mb-2">Imagen</label>
              <div class="flex gap-4 items-start">
                <input
                  type="file"
                  (change)="uploadFachadaImage($event)"
                  accept="image/*"
                  class="flex-1 px-4 py-2 border border-gray-300 rounded-lg">
                @if (datosTecnicos().fijacionesFachada.imagen) {
                  <img 
                    [src]="datosTecnicos().fijacionesFachada.imagen" 
                    alt="Fachada" 
                    class="w-32 h-32 object-cover rounded-lg">
                }
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-black mb-2">Alt text por idioma</label>
              <div class="grid sm:grid-cols-2 gap-3">
                @for (lang of languages; track lang.code) {
                  <div class="space-y-1">
                    <div class="flex items-center justify-between">
                      <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                      @if (lang.code === defaultLanguage) {
                        <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                      }
                    </div>
                    <input
                      type="text"
                      [value]="datosTecnicos().fijacionesFachada.altTranslations?.[lang.code] || (lang.code === defaultLanguage ? (datosTecnicos().fijacionesFachada.alt || '') : '')"
                      (input)="updateFachadaAlt(lang.code, $any($event.target).value)"
                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                      placeholder="Texto alternativo en {{ lang.name }}">
                  </div>
                }
              </div>
              <p class="text-xs text-gray-600 mt-1">Este texto se usarA- como alt de la imagen de fachada.</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-black mb-2">Ventajas</label>
              <div class="mb-3 flex gap-2">
                <input
                  type="text"
                  [(ngModel)]="editingVentaja"
                  placeholder="Nueva ventaja..."
                  class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                <button
                  (click)="addVentaja()"
                  [disabled]="!editingVentaja.trim()"
                  class="px-4 py-2 bg-ts-accent text-white rounded-lg hover:bg-ts-accent/90 disabled:opacity-50">
                  Añadir
                </button>
              </div>

              <div class="space-y-2">
                @for (ventaja of datosTecnicos().fijacionesFachada.ventajas; track $index) {
                  <div class="flex items-center gap-2 p-3 bg-gray-50 rounded-lg border border-gray-200">
                    <svg class="w-5 h-5 text-ts-accent flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <span class="flex-1 text-black">{{ ventaja }}</span>
                    <button
                      (click)="removeVentaja($index)"
                      class="p-1 text-red-600 hover:bg-red-50 rounded">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                      </svg>
                    </button>
                  </div>
                }
                @empty {
                  <p class="text-center text-gray-500 py-4">No hay ventajas configuradas</p>
                }
              </div>
            </div>
          </div>
        </div>
      }

      <!-- Mantenimiento Tab -->
      @if (activeTab() === 'mantenimiento') {
        <div>
          <h2 class="text-xl font-serif font-bold text-black mb-6">Información de Mantenimiento</h2>

          <div class="space-y-6">
            <div>
              <label class="block text-sm font-medium text-black mb-2">Instrucciones de Limpieza</label>
              <textarea
                [value]="datosTecnicos().mantenimiento.limpieza"
                (input)="updateMantenimiento('limpieza', $any($event.target).value)"
                rows="2"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-black mb-2">Limpieza por idioma</label>
              <div class="grid sm:grid-cols-2 gap-3">
                @for (lang of languages; track lang.code) {
                  <div class="space-y-1">
                    <div class="flex items-center justify-between">
                      <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                      @if (lang.code === defaultLanguage) {
                        <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                      }
                    </div>
                    <textarea
                      rows="2"
                      [value]="datosTecnicos().mantenimiento.limpiezaTranslations?.[lang.code] || (lang.code === defaultLanguage ? datosTecnicos().mantenimiento.limpieza : '')"
                      (input)="updateMantenimientoTranslation('limpiezaTranslations', lang.code, $any($event.target).value)"
                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                      placeholder="Limpieza en {{ lang.name }}"></textarea>
                  </div>
                }
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-black mb-2">Frecuencia</label>
              <textarea
                [value]="datosTecnicos().mantenimiento.frecuencia"
                (input)="updateMantenimiento('frecuencia', $any($event.target).value)"
                rows="2"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"></textarea>
            </div>
            <div>
              <label class="block text-sm font-medium text-black mb-2">Frecuencia por idioma</label>
              <div class="grid sm:grid-cols-2 gap-3">
                @for (lang of languages; track lang.code) {
                  <div class="space-y-1">
                    <div class="flex items-center justify-between">
                      <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                      @if (lang.code === defaultLanguage) {
                        <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                      }
                    </div>
                    <textarea
                      rows="2"
                      [value]="datosTecnicos().mantenimiento.frecuenciaTranslations?.[lang.code] || (lang.code === defaultLanguage ? datosTecnicos().mantenimiento.frecuencia : '')"
                      (input)="updateMantenimientoTranslation('frecuenciaTranslations', lang.code, $any($event.target).value)"
                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                      placeholder="Frecuencia en {{ lang.name }}"></textarea>
                  </div>
                }
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-black mb-2">Productos Recomendados</label>
              <div class="mb-3 flex gap-2">
                <input
                  type="text"
                  [(ngModel)]="editingProducto"
                  placeholder="Nuevo producto..."
                  class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                <button
                  (click)="addProducto()"
                  [disabled]="!editingProducto.trim()"
                  class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50">
                  Añadir
                </button>
              </div>

              <div class="space-y-2">
                @for (producto of datosTecnicos().mantenimiento.productos; track $index) {
                  <div class="flex items-center gap-2 p-3 bg-green-50 rounded-lg border border-green-200">
                    <svg class="w-5 h-5 text-green-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <span class="flex-1 text-black">{{ producto }}</span>
                    <button
                      (click)="removeProducto($index)"
                      class="p-1 text-red-600 hover:bg-red-50 rounded">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                      </svg>
                    </button>
                  </div>
                }
                @empty {
                  <p class="text-center text-gray-500 py-4">No hay productos configurados</p>
                }
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-black mb-2">Productos a Evitar</label>
              <div class="mb-3 flex gap-2">
                <input
                  type="text"
                  [(ngModel)]="editingEvitar"
                  placeholder="Nuevo producto a evitar..."
                  class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                <button
                  (click)="addEvitar()"
                  [disabled]="!editingEvitar.trim()"
                  class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50">
                  Añadir
                </button>
              </div>

              <div class="space-y-2">
                @for (evitar of datosTecnicos().mantenimiento.evitar; track $index) {
                  <div class="flex items-center gap-2 p-3 bg-red-50 rounded-lg border border-red-200">
                    <svg class="w-5 h-5 text-red-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                    <span class="flex-1 text-black">{{ evitar }}</span>
                    <button
                      (click)="removeEvitar($index)"
                      class="p-1 text-red-600 hover:bg-red-100 rounded">
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                      </svg>
                    </button>
                  </div>
                }
                @empty {
                  <p class="text-center text-gray-500 py-4">No hay productos a evitar configurados</p>
                }
              </div>
            </div>
          </div>
        </div>
      }

      <!-- Tests Tab -->
      @if (activeTab() === 'tests') {
        <div>
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-xl font-serif font-bold text-black">Tests de Producto</h2>
            <button
              (click)="addTest()"
              class="px-4 py-2 bg-ts-accent text-white rounded-xl hover:bg-ts-accent/90 flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
              Añadir Test
            </button>
          </div>

          <div class="space-y-4">
            @for (test of datosTecnicos().testResults; track $index) {
              <div class="p-4 border border-gray-200 rounded-xl bg-white shadow-sm">
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Nombre del Test</label>
                    <input
                      type="text"
                      [value]="test.nombre"
                      (input)="updateTest($index, 'nombre', $any($event.target).value)"
                      placeholder="ej: Resistencia a la flexión"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-black mb-2">Nombre del Test por idioma</label>
                    <div class="grid sm:grid-cols-2 gap-3">
                      @for (lang of languages; track lang.code) {
                        <div class="space-y-1">
                          <div class="flex items-center justify-between">
                            <span class="text-xs font-semibold text-gray-700">{{ lang.name }} ({{ lang.label }})</span>
                            @if (lang.code === defaultLanguage) {
                              <span class="text-[10px] px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 font-semibold">Default</span>
                            }
                          </div>
                          <input
                            type="text"
                            [value]="test.nombreTranslations?.[lang.code] || (lang.code === defaultLanguage ? test.nombre : '')"
                            (input)="updateTestNombreTranslation($index, lang.code, $any($event.target).value)"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black"
                            placeholder="Nombre en {{ lang.name }}">
                        </div>
                      }
                    </div>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Norma (Opcional)</label>
                    <input
                      type="text"
                      [value]="test.norma || ''"
                      (input)="updateTest($index, 'norma', $any($event.target).value)"
                      placeholder="ej: EN 14411"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Valor Prescrito</label>
                    <input
                      type="text"
                      [value]="test.valorPrescrito"
                      (input)="updateTest($index, 'valorPrescrito', $any($event.target).value)"
                      placeholder="ej: ≥ 35 N/mm²"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-black mb-1">Valor Obtenido</label>
                    <input
                      type="text"
                      [value]="test.valorObtenido"
                      (input)="updateTest($index, 'valorObtenido', $any($event.target).value)"
                      placeholder="ej: 42 N/mm²"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ts-accent text-black">
                  </div>
                </div>
                <div class="flex justify-end mt-4">
                  <button
                    (click)="removeTest($index)"
                    class="px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg text-sm font-medium flex items-center gap-2 border border-red-200">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                    Eliminar Test
                  </button>
                </div>
              </div>
            }
            @empty {
              <p class="text-center text-gray-500 py-8">No hay tests configurados</p>
            }
          </div>
        </div>
      }

    </div>

    <!-- Save Button (Fixed Bottom) -->
    <div class="mt-6 flex justify-end">
      <button
        (click)="saveDatosTecnicos()"
        [disabled]="isSaving()"
        class="px-8 py-3 bg-ts-accent text-white rounded-xl hover:bg-ts-accent/90 transition-colors font-medium shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
        @if (isSaving()) {
          <svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Guardando...
        } @else {
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
          </svg>
          Guardar Cambios
        }
      </button>
    </div>

  </div>

  <!-- Translation Modal -->
  @if (showTranslationModal()) {
    <div class="fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
      <div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75" (click)="closeTranslationModal()"></div>
        
        <div class="inline-block w-full max-w-2xl my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl">
          <div class="bg-gradient-to-r from-green-600 to-green-800 p-6">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center">
                  <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold text-white">Auto-translate Datos Técnicos</h3>
              </div>
              <button (click)="closeTranslationModal()" class="text-white/80 hover:text-white transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>
          </div>

          <div class="p-6">
            <div class="mb-6 p-4 bg-green-50 border border-green-200 rounded-xl">
              <div class="flex items-start gap-3">
                <svg class="w-6 h-6 text-green-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div class="flex-1">
                  <h4 class="font-semibold text-green-900">Technical Data Translation</h4>
                  <ul class="mt-2 space-y-1 text-sm text-green-800">
                    <li>• Translates Spanish content to English, French, and Italian</li>
                    <li>• Translates: Surface finishes, border finishes, technical specs</li>
                    <li>• Translates: Technical datasheets, maintenance info, test results</li>
                    <li>• Existing translations will be overwritten</li>
                    <li>• This may take several minutes depending on content amount</li>
                  </ul>
                </div>
              </div>
            </div>

            @if (translationProgress()) {
              <div class="mb-6 p-4 bg-gray-50 rounded-xl border border-gray-200">
                <pre class="text-sm text-gray-800 whitespace-pre-wrap font-mono">{{ translationProgress() }}</pre>
              </div>
            }

            <div class="space-y-3">
              <button 
                (click)="runDatosTecnicosTranslation()" 
                [disabled]="isTranslating()"
                class="w-full ts-btn ts-btn-primary justify-center disabled:opacity-50 disabled:cursor-not-allowed">
                @if (isTranslating()) {
                  <svg class="animate-spin h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  Translating All Technical Data...
                } @else {
                  Translate All Technical Data
                }
              </button>

              <button 
                (click)="closeTranslationModal()" 
                [disabled]="isTranslating()"
                class="w-full ts-btn ts-btn-outline ts-btn-sm justify-center text-neutral-600 hover:text-neutral-900 disabled:opacity-50">
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>
